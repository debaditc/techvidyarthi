<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Debaditya Chakravorty">
    <meta name="description" content="A simple code to read words in stream and count number of words.
Save the code for word count and run producer with netcat command
from pyspark.sql import SparkSession from pyspark.sql.functions import explode from pyspark.sql.functions import split spark = SparkSession \ .builder \ .appName(&#34;Word Count&#34;) \ .getOrCreate() # Create DataFrame representing the stream of input lines from connection to localhost:9999 lines = spark \ .readStream \ .format(&#34;socket&#34;) \ .option(&#34;host&#34;, &#34;localhost&#34;) \ .">
    <meta name="keywords" content="blog,developer,personal">

    
      <script src="https://twemoji.maxcdn.com/v/latest/twemoji.min.js" crossorigin="anonymous"></script>
    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Basic code : Spark streaming"/>
<meta name="twitter:description" content="A simple code to read words in stream and count number of words.
Save the code for word count and run producer with netcat command
from pyspark.sql import SparkSession from pyspark.sql.functions import explode from pyspark.sql.functions import split spark = SparkSession \ .builder \ .appName(&#34;Word Count&#34;) \ .getOrCreate() # Create DataFrame representing the stream of input lines from connection to localhost:9999 lines = spark \ .readStream \ .format(&#34;socket&#34;) \ .option(&#34;host&#34;, &#34;localhost&#34;) \ ."/>

    <meta property="og:title" content="Basic code : Spark streaming" />
<meta property="og:description" content="A simple code to read words in stream and count number of words.
Save the code for word count and run producer with netcat command
from pyspark.sql import SparkSession from pyspark.sql.functions import explode from pyspark.sql.functions import split spark = SparkSession \ .builder \ .appName(&#34;Word Count&#34;) \ .getOrCreate() # Create DataFrame representing the stream of input lines from connection to localhost:9999 lines = spark \ .readStream \ .format(&#34;socket&#34;) \ .option(&#34;host&#34;, &#34;localhost&#34;) \ ." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/code-concept-post/sparkstream/" />
<meta property="article:published_time" content="2020-08-09T02:47:18-04:00" />
<meta property="article:modified_time" content="2020-08-09T02:47:18-04:00" />


    
      <base href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/code-concept-post/sparkstream/">
    
    <title>
  Basic code : Spark streaming · Debaditya&#39;s Tech Journal
</title>

    
      <link rel="canonical" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/code-concept-post/sparkstream/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/css/coder.min.3219ef62ae52679b7a9c19043171c3cd9f523628c2a65f3ef247ee18836bc90b.css" integrity="sha256-MhnvYq5SZ5t6nBkEMXHDzZ9SNijCpl8&#43;8kfuGINryQs=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.73.0" />
  </head>

  
  
  <body class="colorscheme-light"
        onload=" twemoji.parse(document.body); "
  >
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/">
      Debaditya&#39;s Tech Journal
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/">Home</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/about/">About</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/system-design-post/">System-Design</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/ai-ml-posts/">AI &amp; ML</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/code-concept-post/">Programming</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://techvidyarthi.com.s3-website.us-east-1.amazonaws.com/projects/">Projects</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Basic code : Spark streaming</h1>
    </header>

    <p>A simple code to read words in stream and count number of words.</p>
<p>Save the code for word count and run producer with netcat command</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#fff;font-weight:bold">from</span> pyspark.sql <span style="color:#fff;font-weight:bold">import</span> SparkSession
<span style="color:#fff;font-weight:bold">from</span> pyspark.sql.functions <span style="color:#fff;font-weight:bold">import</span> explode
<span style="color:#fff;font-weight:bold">from</span> pyspark.sql.functions <span style="color:#fff;font-weight:bold">import</span> split

spark = SparkSession \
    .builder \
    .appName(<span style="color:#0ff;font-weight:bold">&#34;Word Count&#34;</span>) \
    .getOrCreate()


<span style="color:#007f7f"># Create DataFrame representing the stream of input lines from connection to localhost:9999</span>
lines = spark \
    .readStream \
    .format(<span style="color:#0ff;font-weight:bold">&#34;socket&#34;</span>) \
    .option(<span style="color:#0ff;font-weight:bold">&#34;host&#34;</span>, <span style="color:#0ff;font-weight:bold">&#34;localhost&#34;</span>) \
    .option(<span style="color:#0ff;font-weight:bold">&#34;port&#34;</span>, <span style="color:#ff0;font-weight:bold">9999</span>) \
    .load()

<span style="color:#007f7f"># Split the lines into words</span>
words = lines.select(
   explode(
       split(lines.value, <span style="color:#0ff;font-weight:bold">&#34; &#34;</span>)
   ).alias(<span style="color:#0ff;font-weight:bold">&#34;word&#34;</span>)
)

<span style="color:#007f7f"># Generate running word count</span>
wordCounts = words.groupBy(<span style="color:#0ff;font-weight:bold">&#34;word&#34;</span>).count()

<span style="color:#007f7f"># Start running the query that prints the running counts to the console</span>
query = wordCounts \
    .writeStream \
    .outputMode(<span style="color:#0ff;font-weight:bold">&#34;complete&#34;</span>) \
    .format(<span style="color:#0ff;font-weight:bold">&#34;console&#34;</span>) \
    .start()

query.awaitTermination()
</code></pre></div><p>For Unix users</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">nc -lk <span style="color:#ff0;font-weight:bold">9999</span>
</code></pre></div><p>For Windows , install nmap from <a href="https://nmap.org/download.html#windows">here</a></p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ncat.exe -lk <span style="color:#ff0;font-weight:bold">9999</span>
</code></pre></div><p>Open another CMD (in Windows) or Terminal (in Linux/Mac) and the run the code to see the result</p>
<div class="highlight"><pre style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">spark-submit sparkstream.py localhost <span style="color:#ff0;font-weight:bold">9999</span>
</code></pre></div>
  </article>
</section>

  

      </div>

      
  <footer class="footer">
    <section class="container">
      
      
        ©
        
        2020
         Debaditya Chakravorty 
      
      
         · 
        Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
    </section>
  </footer>

    </main>

    

    

    

  </body>

</html>
